<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mulcam.run.dao.BoardDAO">
	<!-- 자유게시판 조회 -->
	<select resultType="int" id="selectBoardCount">

		<![CDATA[
			select count(*) from freeboard
		]]>
	</select>

	<!-- 자유게시판 게시물 조회 -->
	<select resultType="board" id="selectBoardList"
		parameterType="int">
		<![CDATA[
			select fb_articleNO,writer,fb_title,fb_content,fb_img_url, fb_date, fb_views,warning 
				from (select @rownum:=@rownum+1 rnum, tot.* 
					from (select * from freeboard order by fb_articleNO asc) tot, 
					(select @rownum:=0) temp) sub
			where rnum between #{startrow} and #{startrow}+9	
		]]>
	</select>

	<!-- 자유게시판 상세 보기 -->
	<select id="selectBoard" resultType="board" parameterType="int">
		<![CDATA[
			select * from freeboard where fb_articleNO=#{fb_articleNO}
		]]>
	</select>

	<!-- 조회수 -->
	<update id="updateReadCount" parameterType="int">
		<![CDATA[
			update freeboard set fb_views=fb_views+1 where fb_articleNO=#{fb_articleNO}
		]]>
	</update>

	<!-- 게시물 삭제 -->
	<delete id="deleteBoard" parameterType="int">
		<![CDATA[
			delete from freeboard where fb_articleNO=#{fb_articleNO}
		]]>
	</delete>

	
	<!-- 최고의 러너 -->
	<select id="bestrun" resultType="Today">
		<![CDATA[
			select * from today order by today_likes desc limit 3;
		]]>
	</select>



	








	<!-- 자유게시판 게시글 생성 -->
	<insert id="insertBoard" parameterType="Board">
		<![CDATA[
			insert into fb (fb_articleNO,writer,fb_title,fb_content,fb_img_url,fb_date,fb_views,warning) 
				values(#{fb_articleNO},#{writer},#{fb_title},#{fb_content},#{fb_img_url},#{fb_date},#{fb_views},#{warning})
		]]>
	</insert>

	<update id="updateFbViews" parameterType="int">
		<![CDATA[
		update fb set fb_views=#{fb_views} where fb_articleNO=#{fb_articleNO}
		]]>
	</update>


	<!-- 게시물 수정 -->
	<update id="updateBoard" parameterType="int">
		<![CDATA[
		update fb set fb_title=#{fb_title},fb_content=#{fb_content}, fb_date=#{fb_date} where fb_articleNO=#{fb_articleNO}
		]]>
	</update>
</mapper>